---
highlight: a11y-dark
---

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34f694d6cec44af58e93c57469d06fa7~tplv-k3u1fbpfcp-zoom-1.image" width="100%" referrerpolicy="no-referrer"></div>



> - ğŸ’¡ ä½œè€…ï¼š[éŸ©ä¿¡å­](https://github.com/HanXinzi-AI)@[ShowMeAI](http://www.showmeai.tech/)
> - ğŸ“˜ [æ·±åº¦å­¦ä¹ å®æˆ˜ç³»åˆ—](http://www.showmeai.tech/tutorials/42)ï¼š[http://www.showmeai.tech/tutorials/42](http://www.showmeai.tech/tutorials/42)
> - ğŸ“˜ [è®¡ç®—æœºè§†è§‰å®æˆ˜ç³»åˆ—](http://www.showmeai.tech/tutorials/46): [http://www.showmeai.tech/tutorials/46](http://www.showmeai.tech/tutorials/46)
> - ğŸ“˜ [æœ¬æ–‡åœ°å€](http://www.showmeai.tech/article-detail/292)ï¼š[http://www.showmeai.tech/article-detail/292](http://www.showmeai.tech/article-detail/292)
> - ğŸ“¢ å£°æ˜ï¼šç‰ˆæƒæ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»å¹³å°ä¸ä½œè€…å¹¶æ³¨æ˜å‡ºå¤„
> - ğŸ“¢ æ”¶è—[ShowMeAI](http://www.showmeai.tech/)æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹

æ®åŒ—äº¬å¬åŠ›åä¼šé¢„ä¼°æ•°æ®ï¼Œæˆ‘å›½å¬éšœäººç¾¤æ•°é‡å·²è¿‡åƒä¸‡ã€‚è€Œåœ¨å…¨çƒèŒƒå›´å†…æœ‰4.66äº¿äººæ‚£æœ‰æ®‹ç–¾æ€§å¬åŠ›æŸå¤±ï¼Œçº¦å å…¨ä¸–ç•Œäººå£çš„5%ã€‚è‹å“‘äººå£«å¾ˆç‰¹æ®Šï¼Œä»–ä»¬éœ€è¦ä½¿ç”¨æ‰‹è¯­è¿›è¡Œäº¤æµï¼Œå…¶ä»–ä¸å¸¸äººæ— å¼‚ï¼Œæˆ‘å›½å­˜åœ¨ç‰¹æ®Šæ•™è‚²æ°´å¹³åœ¨å„åŸå¸‚ä¸­å‘å±•åŠ›åº¦å…·æœ‰è¾ƒå¤§å·®å¼‚ï¼Œå›½å®¶é€šç”¨æ‰‹è¯­æ¨å¹¿ç¨‹åº¦æµ…ï¼Œä½†ä¸æ‡‚æ‰‹è¯­ï¼Œä¸å¬åŠ›éšœç¢è€…äº¤æµä¼šéå¸¸å›°éš¾ã€‚

åœ¨æœ¬ç¯‡å†…å®¹ä¸­ï¼ŒShowMeAI å€ŸåŠ©æ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œæŠ€æœ¯ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜ä» 0 æ„å»º 1 ä¸ªåº”ç”¨ç¨‹åºï¼Œæ£€æµ‹æ‰‹è¯­å¹¶å°†å…¶ç¿»è¯‘ç»™å…¶ä»–äººè¿›è€Œæ‰“ç ´æ‰‹è¯­éš”é˜‚ã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/91f0d27c09944cea9dec77693389cf21~tplv-k3u1fbpfcp-zoom-1.image" width="40%" referrerpolicy="no-referrer"></div>

æ­å»ºå’Œéƒ¨ç½²å®Œæˆåï¼Œä½ å¯ä»¥é€šè¿‡æ‘„åƒå¤´ï¼Œè½»æ¾æµ‹è¯•æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¿«æ¥ä¸€èµ·è¯•è¯•å§ã€‚è¿™ä¸ªåŠ¨å›¾ä¸­çš„æ‰‹åŠ¿ä»£è¡¨çš„å•è¯ï¼Œè§æ–‡æœ«å“¦ï¼

## ğŸ’¡ æ‰‹è¯­ä»‹ç»

æˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹æ‰‹è¯­ï¼Œå®ƒç”± 3 ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š

- **æ‰‹æŒ‡æ‹¼å†™**ï¼šè¿™æ˜¯ä¸€ç§æ‰‹åŠ¨çš„äº¤æµæ–¹å¼ï¼Œç”¨åŒæ‰‹å’Œæ‰‹æŒ‡æ‹¼å†™å•è¯ã€‚æ¯ä¸ªå­—æ¯éƒ½ç”¨æŒ‡å®šçš„æ‰‹ä½ç½®è¡¨ç¤ºã€‚
- **å•è¯çº§ç¬¦å·è¯æ±‡**ï¼šè¿™æ˜¯ä¸€ä¸ªå¤§å‹è§†é¢‘æ•°æ®é›†ï¼Œç”¨äºè¯†åˆ«å•è¯æˆ–å­—æ¯çš„æ•´ä¸ªæ‰‹åŠ¿ã€‚
- **éæ‰‹éƒ¨ç‰¹å¾**ï¼šåŒ…æ‹¬ä»»ä½•é¢éƒ¨è¡¨æƒ…ã€å˜´å·´ã€èˆŒå¤´æˆ–èº«ä½“å§¿åŠ¿ã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a053e9a50871431b832e92d73fba9c52~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å…ˆè§£å†³ç¬¬â‘ ä¸ªéƒ¨åˆ†çš„é—®é¢˜ã€‚æˆ‘ä»¬å‡†å¤‡ä½¿ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯åŸºäºè§†è§‰æ•°æ®çš„ç¥ç»ç½‘ç»œ

## ğŸ’¡ æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰

äººå·¥æ™ºèƒ½å’Œè®¡ç®—æœºè§†è§‰çš„æœ€å…¸å‹çš„æ¨¡å‹æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ï¼Œå®ƒåœ¨å…¸å‹çš„è®¡ç®—æœºè§†è§‰åº”ç”¨ä¸­ï¼ˆå¦‚å›¾åƒè¯†åˆ«ã€ç›®æ ‡æ£€æµ‹ç­‰ï¼‰åº”ç”¨å¹¿æ³›ã€‚æˆ‘ä»¬åœ¨æœ¬æ¬¡åº”ç”¨çš„æ ¸å¿ƒæŠ€æœ¯ä¹Ÿå°†é‡‡ç”¨ CNNã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ebe6b27ee8c41418ac70da9b8b12fb5~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

CNN ç½‘ç»œæœ‰ç€å¦‚ä¸Šå›¾æ‰€ç¤ºçš„ç½‘ç»œç»“æ„ï¼Œå…¸å‹çš„ç»“æ„åŒ…æ‹¬å·ç§¯å±‚ã€æ± åŒ–å±‚ã€æ¿€æ´»å±‚ã€å…¨è¿æ¥å±‚ç­‰ï¼Œå¯¹äºè¾“å…¥å›¾åƒï¼Œå¯ä»¥æœ‰æ•ˆæŠ½å–å›¾åƒå†…å®¹è¡¨å¾ï¼Œå¹¶è¿›è¡Œåˆ†ç±»æˆ–å…¶ä»–å¤„ç†ã€‚å·ç§¯å±‚ç­‰ç‰¹æ®Šç»“æ„ï¼Œå¯ä»¥åœ¨æ§åˆ¶å‚æ•°é‡çš„å‰æä¸‹ï¼Œä¿è¯è‰¯å¥½çš„å›¾åƒç‰¹å¾æå–èƒ½åŠ›ã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a6d3d5fd48434241b9e507218696179a~tplv-k3u1fbpfcp-zoom-1.image" width="100%" referrerpolicy="no-referrer"></div>




> å…³äºå·ç§¯ç¥ç»ç½‘ç»œçš„è¯¦ç»†çŸ¥è¯†å¯ä»¥å‚è€ƒ[ShowMeAI](http://www.showmeai.tech/)ä¸‹è¿°æ•™ç¨‹ï¼š
> - [ShowMeAI](http://www.showmeai.tech/)çš„ [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ | å´æ©è¾¾ä¸“é¡¹è¯¾ç¨‹ Â· å…¨å¥—ç¬”è®°è§£è¯»**](http://www.showmeai.tech/tutorials/35) ä¸­çš„æ–‡ç«  [**å·ç§¯ç¥ç»ç½‘ç»œè§£è¯»**](http://www.showmeai.tech/article-detail/221)
> - [ShowMeAI](http://www.showmeai.tech/)çš„ [**æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰æ•™ç¨‹**](http://www.showmeai.tech/tutorials/37) ä¸­çš„æ–‡ç«  [**å·ç§¯ç¥ç»ç½‘ç»œè¯¦è§£**](http://www.showmeai.tech/article-detail/264)

## ğŸ’¡ å°è¯•ç‰›åˆ€ï¼Œæ‰“é€šæµç¨‹

æˆ‘ä»¬æ¥æ„å»ºä¸€ä¸ª CNN è¯†åˆ«çš„æµç¨‹ï¼Œä¼šåˆ†æˆä»¥ä¸‹åŸºç¡€æ­¥éª¤ï¼š

- æ•°æ®è¯»å–ä¸åˆ‡åˆ†
- æ•°æ®å¯è§†åŒ–åŠé¢„å¤„ç†
- CNNç½‘ç»œæ„å»ºä¸è®­ç»ƒ

### â‘  å¯¼å…¥ç›¸å…³åº“

æˆ‘ä»¬åœ¨è¿™é‡Œä¸»è¦ä½¿ç”¨ TensorFlow æ„å»ºç½‘ç»œä¸è®­ç»ƒï¼Œä¼šä½¿ç”¨ Numpy åšæ•°æ®è®¡ç®—ä¸å¤„ç†ï¼Œä»¥åŠä½¿ç”¨ Matplotlib è¿›è¡Œç®€å•å¯è§†åŒ–ã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cb3dd67d5bcb437a8d88989f9897d88b~tplv-k3u1fbpfcp-zoom-1.image" width="100%" referrerpolicy="no-referrer"></div>



> å¯¹äºè¿™äº›å·¥å…·åº“ï¼ŒShowMeAIéƒ½åˆ¶ä½œäº†å¿«æ·å³æŸ¥å³ç”¨çš„é€ŸæŸ¥è¡¨æ‰‹å†Œï¼Œå¤§å®¶å¯ä»¥åœ¨ä¸‹è¿°ä½ç½®è·å¾—ï¼š
> - [**Tensorflow é€ŸæŸ¥æ‰‹å†Œ**](http://www.showmeai.tech/article-detail/109)
> - [**Numpy é€ŸæŸ¥æ‰‹å†Œ**](http://www.showmeai.tech/article-detail/100)
> - [**Matplotlib é€ŸæŸ¥æ‰‹å†Œ**](http://www.showmeai.tech/article-detail/103)

æˆ‘ä»¬å…ˆæŠŠè¿™äº›å·¥å…·åº“å¯¼å…¥ã€‚

```
# å¯¼å…¥å·¥å…·åº“
import string
import pandas as pd
import numpy as np
import tensorflow as tf
import matplotlib.pyplot as plt
from tensorflow import keras
from functools import partial
from tensorflow.keras.preprocessing.image import ImageDataGenerator, array_to_img
```

### â‘¡ è¯»å–æ•°æ®é›†

æœ¬æ•°æ®é›†ä¸ºæ‰‹è¯­å­—æ¯å¯¹åº”çš„æ•°æ®é›†ï¼Œå›¾ç‰‡ size ä¸å¤§ï¼Œæ‰€ä»¥ä¹Ÿå«åš sign_mnist æ•°æ®é›†ï¼ˆç±»æ¯”æ‰‹å†™æ•°å­—æ•°æ®é›† mnistï¼‰ï¼Œéƒ¨åˆ†ç¤ºä¾‹å›¾ç‰‡å¦‚ä¸‹

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c53ea47a2ac47e28df524d58db4e54d~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

æ•°æ®é›†å¤§å®¶å¯ä»¥åœ¨ ğŸ†[**Kaggleå¹³å°å¯¹åº”æ•°æ®é›†é¡µé¢**](https://www.kaggle.com/datasets/datamunge/sign-language-mnist) ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ShowMeAIçš„ç™¾åº¦ç½‘ç›˜åœ°å€ä¸‹è½½ã€‚

> ğŸ† **å®æˆ˜æ•°æ®é›†ä¸‹è½½ï¼ˆç™¾åº¦ç½‘ç›˜ï¼‰**ï¼šå…¬ä¼—å·ã€ShowMeAIç ”ç©¶ä¸­å¿ƒã€å›å¤ã€**å®æˆ˜**ã€ï¼Œæˆ–è€…ç‚¹å‡» [**è¿™é‡Œ**](http://www.showmeai.tech/article-detail/305) è·å–æœ¬æ–‡ [[5] ä»0æ­å»ºåŸºäºç¥ç»ç½‘ç»œçš„æ‰‹è¯­è¯†åˆ«ç³»ç»Ÿ](http://www.showmeai.tech/article-detail/292)ã€**sign_mnist æ•°æ®é›†**ã€

> â­ **ShowMeAIå®˜æ–¹GitHub**ï¼š[https://github.com/ShowMeAI-Hub](https://github.com/ShowMeAI-Hub)

ä¸‹é¢æˆ‘ä»¬åŠ è½½è®­ç»ƒé›†ä¸æµ‹è¯•é›†å¹¶åˆ‡åˆ†ç‰¹å¾ä¸æ ‡ç­¾ï¼š

```
# è¯»å–æ•°æ®
test = pd.read_csv("sign_mnist_test.csv")
train = pd.read_csv("sign_mnist_train.csv")

# è¾“å‡ºåŸºæœ¬ä¿¡æ¯
print("è®­ç»ƒé›†ç»´åº¦", train.shape)
print("æµ‹è¯•é›†ç»´åº¦", train.shape)
```

```
# è¾“å‡ºæ ‡ç­¾ä¿¡æ¯
labels = train["label"].value_counts().sort_index(ascending=True)
labels
```

```
# åˆ‡åˆ†ç‰¹å¾ä¸æ ‡ç­¾
train_x = train.drop(labels = "label", axis = 1)
train_y = train["label"]
test_x = test.drop(labels = "label", axis = 1)
test_y = test["label"]
train_x.head()
```

```
# æ•°æ®é¢„å¤„ç†ä¸å¯è§†åŒ–

# å­˜å‚¨æ ‡ç­¾æ•°æ®
test_classes= test_y
train_clasees = train_y

# ç‰¹å¾è½¬ä¸ºnumpyæ ¼å¼
train_x = train_x.to_numpy()
test_x = test_x.to_numpy()

# æŠŠæ•°æ®è½¬ä¸º3ç»´å›¾åƒæ•°æ®ï¼ˆå›¾ç‰‡æ•°é‡*å®½*é«˜ï¼Œè¿™é‡Œå¦‚æœæ˜¯ç°åº¦å›¾ï¼Œé¢œè‰²é€šé“ä¸º1ï¼Œçœç•¥ï¼‰
train_x = train_x.reshape(-1,28,28)
test_x = test_x.reshape(-1,28,28)
```

```
# åœ¨è®­ç»ƒé›†ä¸­å–æ ·30å¼ å›¾ç‰‡ï¼Œåšå¯è§†åŒ–æŸ¥çœ‹
def plot_categories(training_images, training_labels):
    fig, axes = plt.subplots(3, 10, figsize=(16, 15))
    axes = axes.flatten()
    letters = list(string.ascii_lowercase)

    for k in range(30):
        img = training_images[k]
        img = np.expand_dims(img, axis=-1)
        img = array_to_img(img)
        ax = axes[k]
        ax.imshow(img, cmap="Greys_r")
        ax.set_title(f"{letters[int(training_labels[k])]}")
        ax.set_axis_off()

    plt.tight_layout()
    plt.show()

plot_categories(train_x, train_y)
```

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2afd215fcefd470892a47c0711c8297f~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

### â‘¢ å·ç§¯ç¥ç»ç½‘ç»œCNNæ­å»º

æˆ‘ä»¬ä½¿ç”¨ TensorFlow çš„ high level APIï¼ˆå³kerasï¼‰æ­å»ºä¸€ä¸ªç®€æ˜“CNNç¥ç»ç½‘ç»œï¼Œå¹¶æ‹Ÿåˆä¸€ä¸‹æ•°æ®

```
def create_model():
    model = tf.keras.models.Sequential([
    # å·ç§¯å±‚
    tf.keras.layers.Conv2D(32, (3,3), activation='relu', input_shape=(28, 28, 1)),
    # æ± åŒ–å±‚
    tf.keras.layers.MaxPooling2D(2,2),
    # å·ç§¯å±‚
    tf.keras.layers.Conv2D(32, (3,3), activation='relu'),
    # æ± åŒ–å±‚
    tf.keras.layers.MaxPooling2D(2,2),
    # å±•å¹³
    tf.keras.layers.Flatten(),
    # å…¨è¿æ¥å±‚
    tf.keras.layers.Dense(512, activation='relu'),
    # softmaxåˆ†ç±»
    tf.keras.layers.Dense(26, activation='softmax')])

    model.compile(
    optimizer='adam',  #ä¼˜åŒ–å™¨
    loss='sparse_categorical_crossentropy',  #æŸå¤±å‡½æ•°
    metrics=['accuracy']) #è¯„ä¼°å‡†åˆ™
  
    return model
```

```
# åˆå§‹åŒ–æ¨¡å‹
model = create_model()
# æ‹Ÿåˆæ•°æ®
history = model.fit(train_x, train_y, epochs=20, validation_data=(test_x, test_y))
```

æˆ‘ä»¬è¿™é‡Œåœ¨å…¨é‡æ•°æ®é›†ä¸Šè¿­ä»£20ä¸ªè½®æ¬¡ï¼Œç»“æœå¦‚ä¸‹ï¼š

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7dd923f05104eafa2a8bbb2c3eb24c6~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„æ•°æ®å¹¶ä¸ç‰¹åˆ«å¤æ‚ï¼Œåœ¨è‡ªå·±ä»å¤´æ­å»ºçš„ CNN æ¨¡å‹ä¸Šï¼Œç»è¿‡è®­ç»ƒå¯ä»¥è¾¾åˆ°è®­ç»ƒé›† 100% éªŒè¯é›† 92% çš„å‡†ç¡®ç‡ã€‚

æˆ‘ä»¬å†å¯¹è®­ç»ƒè¿‡ç¨‹ä¸­çš„ã€Œå‡†ç¡®ç‡ã€åŠã€ŒæŸå¤±å‡½æ•°ã€å˜åŒ–å€¼è¿›è¡Œç»˜åˆ¶ï¼Œä»¥äº†è§£æ¨¡å‹çŠ¶æ€ã€‚

```
# è·å–å‡†ç¡®ç‡ä¸æŸå¤±å‡½æ•°æƒ…å†µ
acc = history.history['accuracy']
val_acc = history.history['val_accuracy']
loss = history.history['loss']
val_loss = history.history['val_loss']

# matplotlibç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­æŒ‡æ ‡çš„å˜åŒ–çŠ¶å†µ
epochs = range(len(acc))

plt.plot(epochs, acc, 'r', label='Training accuracy')
plt.plot(epochs, val_acc, 'b', label='Validation accuracy')
plt.title('Training and validation accuracy')
plt.legend()
plt.figure()

plt.plot(epochs, loss, 'r', label='Training Loss')
plt.plot(epochs, val_loss, 'b', label='Validation Loss')
plt.title('Training and validation loss')
plt.legend()

plt.show()
```

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44d2bb94a2d64ad0922125698f98d98a~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

## ğŸ’¡ é—®é¢˜ä¸ä¼˜åŒ–

### â‘  æ·±åº¦ç½‘ç»œä¸æ¢¯åº¦æ¶ˆå¤±

ä¸€èˆ¬æ¥è¯´ï¼Œéšç€ CNN ç½‘ç»œå±‚æ•°å˜æ·±ï¼Œæ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ä¼šå˜å¼ºï¼Œä¹Ÿèƒ½å­¦åˆ°æ›´å¤šçš„ä¿¡æ¯ã€‚ä½†è®­ç»ƒæ·±åº¦CNNå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fd3c6c9be5714a6aabfa7e1184c5d97c~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

> æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸éƒ¨åˆ†å†…å®¹ä¹Ÿå¯ä»¥å‚è€ƒ[ShowMeAI](http://www.showmeai.tech/)çš„å¯¹å´æ©è¾¾è€å¸ˆè¯¾ç¨‹çš„æ€»ç»“æ–‡ç«  [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ | æ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢**](http://www.showmeai.tech/article-detail/216)

éå¸¸æ·±çš„ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¼šå¾ˆå¿«å˜ä¸ºé›¶ï¼ˆåå‘ä¼ æ’­çš„æ¢¯åº¦è¿ä¹˜å¸¦æ¥çš„é—®é¢˜ï¼‰ï¼Œè¿™æœ€ç»ˆä¼šä½¿æ•´ä¸ªæ¢¯åº¦ä¸‹é™å˜æ…¢ã€‚æœ‰ä¸€äº›ç‰¹æ®Šç»“æ„çš„ç¥ç»ç½‘ç»œï¼Œå¯ä»¥å¤§ç¨‹åº¦ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚æœ€è‘—åçš„ ResNetï¼Œå½“ç„¶ï¼Œå¤§å®¶å¯ä»¥å€ŸåŠ© ResNet é¢„è®­ç»ƒæ¨¡å‹å¿«é€Ÿè¿ç§»å­¦ä¹ åº”ç”¨åœ¨æˆ‘ä»¬å½“å‰çš„æ‰‹è¯­è¯†åˆ«é—®é¢˜ä¸Šï¼Œä¸ºäº†è®©å¤§å®¶å¯¹ResNet ç»†èŠ‚æ›´æ¸…æ™°ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ‰‹åŠ¨æ­å»º ResNet-50ï¼ˆå³50å±‚çš„ResNetç½‘ç»œï¼‰æ¥è®­ç»ƒå’Œåšæ•ˆæœå¯¹æ¯”ã€‚

> ResNetçš„è¯¦ç»†è®²è§£ä¹Ÿå¯ä»¥å‚è€ƒ[ShowMeAI](http://www.showmeai.tech/)çš„ [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ | å´æ©è¾¾ä¸“é¡¹è¯¾ç¨‹ Â· å…¨å¥—ç¬”è®°è§£è¯»**](http://www.showmeai.tech/tutorials/35)ä¸­çš„æ–‡ç«  [**æ·±åº¦å­¦ä¹ æ•™ç¨‹ | ç»å…¸CNNç½‘ç»œå®ä¾‹è¯¦è§£**](http://www.showmeai.tech/article-detail/222)ã€‚

### â‘¡ ResNet æ¨¡å‹ç®€ä»‹

ResNet æ˜¯ Residual Networks çš„ç®€ç§°ï¼Œæ˜¯è¿„ä»Šä¸ºæ­¢æˆ‘ä»¬çœ‹åˆ°çš„æœ€æµè¡Œå’Œæœ€æˆåŠŸçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä¹‹ä¸€ã€‚ResNets ç”±æ®‹å·®å—ç»„æˆï¼Œæ®‹å·®å—çš„æ ¸å¿ƒç»„ä»¶æ˜¯ã€è·³è·ƒè¿æ¥/skip-connectionã€ã€‚è·³è·ƒè¿æ¥ï¼Œä¹Ÿç§°ä¸ºå¿«æ·è¿æ¥ï¼Œè®©ç¥ç»ç½‘ç»œè·³è¿‡æŸäº›å±‚å¹¶å°†ä¸€å±‚çš„è¾“å‡ºé¦ˆé€åˆ°ç¥ç»ç½‘ç»œä¸­å¦ä¸€å±‚çš„è¾“å…¥ã€‚å®ƒèƒ½å¸®åŠ©æ¨¡å‹é¿å…ä¹˜ä»¥ä¸­é—´è·³è¿‡çš„é‚£äº›å±‚çš„æƒé‡ï¼Œä»è€Œæœ‰åŠ©äºè§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚

ç„¶è€Œï¼Œä½¿ç”¨ ResNet å’Œè·³è·ƒè¿æ¥ï¼Œç”±äºä¸­é—´æœ‰å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œä¸€å±‚è¾“å‡ºçš„ç»´åº¦å¯èƒ½ä¸å¦ä¸€å±‚çš„è¾“å‡ºç»´åº¦ä¸åŒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹æ³•ï¼š

- å¿«æ·è¿æ¥å¡«å……å¤šä¸ªé›¶å®ä½“ä»¥å¢åŠ å…¶ç»´åº¦
- æ·»åŠ  1X1 å·ç§¯å±‚æ¥åŒ¹é…ç»´åº¦ã€‚

ä½†æ˜¯ï¼Œå¯¹äºç¬¬äºŒç§æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¾“å‡ºä¸­æ·»åŠ ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œè€Œç¬¬ä¸€ç§æ–¹æ³•ä¸éœ€è¦ã€‚

### â‘¢ ResNetä¸ºä½•æœ‰æ•ˆ

ResNetçš„æ•ˆæœæ ¸å¿ƒæœ‰2ç‚¹ï¼š

- â‘  å®ƒä½¿ç”¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„è·³è·ƒè¿æ¥ï¼Œå®ƒè·³è¿‡å±‚æ¥è§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚
- â‘¡ å®ƒé€šè¿‡è®©æ¨¡å‹å­¦ä¹ æ’ç­‰å‡½æ•°æ¥ç¡®ä¿æœ€é«˜å±‚çš„æ€§èƒ½è‡³å°‘ä¸æœ€ä½å±‚ä¸€æ ·å¥½ã€‚

### â‘£ æ„å»ºResNet-50

ä¸‹é¢æˆ‘ä»¬å‚è€ƒ keras å®˜æ–¹ ResNet æ„å»ºæ–¹å¼ï¼Œæ„å»ºä¸€ä¸ª ResNet-50ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å…ˆæ„å»ºåŸºæœ¬æ¨¡å—ï¼Œå†ç»„è£…æˆæœ€ç»ˆçš„ç½‘ç»œã€‚

```
# Defining the identity block of the Resnet-50 Model. 
def identity_block(X, f, filters, training=True):
    # filter of the three convs 
    f1,f2,f3 = filters
    X_shortcut = X 
    
    # First Component 
    X = tf.keras.layers.Conv2D(filters = f1, kernel_size = 1, strides = (1,1), padding = 'valid')(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X, training = training) # Default axis
    X = tf.keras.layers.Activation('relu')(X)
   
    # Second Component 
    X = tf.keras.layers.Conv2D(filters = f2, kernel_size = f, strides = (1,1), padding = 'same')(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X, training = training) # Default axis
    X = tf.keras.layers.Activation('relu')(X)
   
    # Third Component 
    X = tf.keras.layers.Conv2D(filters = f3, kernel_size = 1, strides = (1,1), padding = 'valid')(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X, training = training) # Default axis
    
    # Adding the two tensors 
    X = tf.keras.layers.Add()([X_shortcut,X])
    X = tf.keras.layers.Activation('relu')(X)
    
    # Returning the last output
    return X
```

```
# Defining the Convolution Block of the Resnet-50 Model. 
def convolutional_block(X, f, filters, s=2,training=True):
    # filter of the three convs 
    f1,f2,f3 = filters
    X_shortcut = X 
    
    # First Component 
    X = tf.keras.layers.Conv2D(filters = f1, kernel_size = 1, strides = (1,1), padding = 'valid')(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X, training = training) # Default axis
    X = tf.keras.layers.Activation('relu')(X)
    
    # Second Component 
    X = tf.keras.layers.Conv2D(filters = f2, kernel_size = f, strides = (s,s), padding = 'same')(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X, training = training) # Default axis
    X = tf.keras.layers.Activation('relu')(X)
    
    # Third Component 
    X = tf.keras.layers.Conv2D(filters = f3, kernel_size = 1, strides = (1,1), padding = 'valid')(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X, training = training) # Default axis
    
    # Converting the Input Volume to the match the last output for addition. 
    X_shortcut =tf.keras.layers.Conv2D(filters = f3, kernel_size = 1, strides = (s,s), padding = 'valid')(X_shortcut)
    X_shortcut = tf.keras.layers.BatchNormalization(axis = 3)(X_shortcut, training = training)
    X = tf.keras.layers.Add()([X_shortcut,X])
    X = tf.keras.layers.Activation('relu')(X)
    
    # Adding the last two tensors
    X = tf.keras.layers.Add()([X, X_shortcut])
    X = tf.keras.layers.Activation('relu')(X)
    
    # Returning the output tensor
    return X
```

```
# Defining a modified Resnet-50 Model using the Identity and Convolution Blocks. 
def ResNet50(input_shape = (28, 28, 1), classes = 26):
    
    # Defining the input as a tensor with shape input_shape
    X_input = tf.keras.Input(input_shape)
    
    # Zero-Padding
    X = tf.keras.layers.ZeroPadding2D((3, 3))(X_input)
    
    # Stage 1
    X = tf.keras.layers.Conv2D(64, (5, 5), strides = (1, 1))(X)
    X = tf.keras.layers.BatchNormalization(axis = 3)(X)
    X = tf.keras.layers.Activation('relu')(X)
    X = tf.keras.layers.MaxPooling2D((3, 3), strides=(2, 2))(X)

    # Stage 2
    X = convolutional_block(X, f = 3, filters = [64, 64, 256], s = 1)
    X = identity_block(X, 3, [64, 64, 256])
    X = identity_block(X, 3, [64, 64, 256])
    
    # Add an Average Pool Layer
    X = tf.keras.layers.AveragePooling2D((2,2))(X)

    # Output Layer
    X = tf.keras.layers.Flatten()(X)
    X = tf.keras.layers.Dense(classes, activation='softmax')(X)
    
    # Create Model
    model = tf.keras.Model(inputs = X_input, outputs = X)

    return model
```

### â‘¤ è®­ç»ƒResNet-50

ä¸‹é¢æˆ‘ä»¬åœ¨æ•°æ®é›†ä¸Šï¼Œä½¿ç”¨ ResNet-50 ç½‘ç»œè¿›è¡Œè®­ç»ƒ

```
# åˆå§‹åŒ–æ¨¡å‹
model = ResNet50()

# ç¼–è¯‘
model.compile(optimizer="adam",metrics=["accuracy"],loss = "sparse_categorical_crossentropy")

# è®­ç»ƒ
history = model.fit(train_x, train_y, validation_data = (test_x, test_y), epochs =10)
```

å¾—åˆ°å¦‚ä¸‹ç»“æœ

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/85511f4bbc0243a1919138c3754ea95a~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

## ğŸ’¡ ä¼˜åŒ–æ•ˆæœå¯¹æ¯”

æˆ‘ä»¬å¯¹ResNet-50ä¹Ÿç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­å‡†ç¡®ç‡å’ŒæŸå¤±å‡½æ•°çš„å˜åŒ–ï¼Œå¦‚ä¸‹

```
# è·å–å‡†ç¡®ç‡ä¸æŸå¤±å‡½æ•°æƒ…å†µ
acc = history.history['accuracy']
val_acc = history.history['val_accuracy']
loss = history.history['loss']
val_loss = history.history['val_loss']

# matplotlibç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­æŒ‡æ ‡çš„å˜åŒ–çŠ¶å†µ
epochs = range(len(acc))

plt.plot(epochs, acc, 'r', label='Training accuracy')
plt.plot(epochs, val_acc, 'b', label='Validation accuracy')
plt.title('Training and validation accuracy')
plt.legend()
plt.figure()

plt.plot(epochs, loss, 'r', label='Training Loss')
plt.plot(epochs, val_loss, 'b', label='Validation Loss')
plt.title('Training and validation loss')
plt.legend()

plt.show()
```

å¯¹æ¯”å›¾å¦‚ä¸‹ï¼š

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44bf25a16826468287674d2a893a8c44~tplv-k3u1fbpfcp-zoom-1.image" width="70%" referrerpolicy="no-referrer"></div>

æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œä»ç®€å•çš„ CNN æ¨¡å‹æ¢åˆ° ResNet æ¨¡å‹æ—¶ï¼Œæµ‹è¯•é›†çš„å‡†ç¡®ç‡ä»92% åˆ° 97% ã€‚ä¹Ÿè¯´æ˜äº†ï¼ŒResNet çš„ç»“æ„ç¡®å®èƒ½å¤Ÿå¸¦æ¥æ•ˆæœä¸Šçš„æå‡ã€‚

## ğŸ’¡ éƒ¨ç½²ä¸å®æ—¶æµ‹è¯•

åœ¨è¿™é‡Œæˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œä½¿ç”¨ OpenCV çš„è§†é¢‘å½•åˆ¶åŠŸèƒ½ï¼Œé€šè¿‡ python æ”¶é›†æˆ‘ä»¬çš„æ‘„åƒå¤´çš„é•œå¤´é‡‡é›†çš„å›¾åƒå¹¶è¿›è¡Œå®æ—¶é¢„æµ‹ã€‚

> ShowMeAIç»™OpenCVå·¥å…·åº“åˆ¶ä½œäº†å¿«æ·å³æŸ¥å³ç”¨çš„ [**OpenCV é€ŸæŸ¥è¡¨æ‰‹å†Œ**](http://www.showmeai.tech/article-detail/112)ï¼Œå¤§å®¶å¯ä»¥ç‚¹å‡»æŸ¥çœ‹å’Œä¸‹è½½ã€‚

å…·ä½“çš„è¿‡ç¨‹æ˜¯ï¼Œæˆ‘ä»¬è§£ææ•è·çš„æ¯ä¸€å¸§å›¾åƒï¼Œå°†å…¶å¤„ç†ä¸ºç°åº¦å›¾ï¼ˆç±»ä¼¼äºæˆ‘ä»¬æ¨¡å‹çš„è®­ç»ƒé›†ï¼‰ï¼Œåœ¨å›¾åƒä¸­å¿ƒæŠ“å–ä¸€ä¸ª 400*400 åƒç´ çš„æ­£æ–¹å½¢åŒºåŸŸï¼ˆå‚è§ x0,x1,y0,y1ï¼‰ï¼Œå°†æ­£æ–¹å½¢è°ƒæ•´ä¸ºæˆ‘ä»¬æœ€åˆçš„ 28x28 å¤§å°å¹¶ä½¿ç”¨æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œæµ‹è¯•ï¼ˆä¹‹å‰ä¿å­˜åˆ° .h5 æ–‡ä»¶ï¼‰ã€‚

```
# å¯¼å…¥å·¥å…·åº“
import keras
import numpy as np
from PIL import Image
import string
import pandas as pd
import tensorflow as tf
```

```
# å¯¼å…¥OpenCV
import cv2
from matplotlib import pyplot

## è®¾å®šç»´åº¦
dim = (28, 28) # å›¾åƒç»´åº¦
letters = list(string.ascii_lowercase) # è¯†åˆ«çš„å­—æ¯

x0 = 1920 // 2 - 400 # 400px left of center
x1 = 1920 // 2 + 400 # 400px right of center
y0 = 1080 // 2 - 400 # 400px right of center
y1 = 1080 // 2 + 400 # 400px right of center

# åˆå§‹åŒ–è§†é¢‘æ•è·
video=cv2.VideoCapture(0)

cv2.namedWindow('Webcam') # æ„å»º1ä¸ªçª—å£
cv2.moveWindow('Webcam',40,30) # æ”¾ç½®çª—å£

while video.isOpened(): # åªè¦æ²¡æœ‰å…³æ‰å®æ—¶æ‘„åƒå¤´
    ret,capture = video.read() # æŠ“å–æ¯ä¸ªè§†é¢‘å¸§
    cropped = capture[y0:y1, x0:x1] # æˆªå–
    img = cv2.cvtColor(cropped, cv2.COLOR_BGR2GRAY) # è½¬æˆç°åº¦å›¾
    img = cv2.GaussianBlur(img, (5, 5), 0) # å›¾åƒå¹³æ»‘
    img = cv2.resize(img, dim) # å›¾åƒå¤§å°ç¼©æ”¾
    pyplot.imshow(img, cmap='gray') # å¯è§†åŒ–å±•ç¤ºå›¾ç‰‡
    pyplot.show() # å±•ç¤º
    img = np.reshape(img, (1,img.shape[0],img.shape[1],1))
    img = tf.cast(img, tf.float32)
    pred=model.predict(img)

    # å¯è§†åŒ–å®æ—¶æ•ˆæœ
    cv2.rectangle(capture, (x0,y0),(x1,y1),(255,0,0),2) # ä¸ºå›¾ç‰‡æ·»åŠ çŸ©å½¢æ¡†
    cv2.putText(capture,'{} res50'.format(letters[np.argmax(pred[0])]),(x0+25,y0+50),cv2.FONT_HERSHEY_SIMPLEX,0.9,(0,255,0),1) # é¢„æµ‹å­—æ¯
    cv2.imshow('Webcam', capture) # å±•ç¤ºè§†é¢‘
    
    # ç»“æœè¾“å‡º
    print(pred)
    print(letters[np.argmax(pred[0])])
    
    # é€€å‡ºè§†é¢‘è¾“å…¥
    key = cv2.waitKey(1)
    if key == ord('q'):
        break
video.release()
cv2.destroyAllWindows()
```

ä¸ºäº†æ›´è½»æ¾åœ°å¯¹é¢„ä¼°ç»“æœæŸ¥çœ‹ï¼Œæˆ‘ä»¬æŠŠå°†é¢„æµ‹çš„å­—æ¯æ˜¾ç¤ºåœ¨å®æ—¶ç”»é¢ä¸Šï¼ˆè¯·å‚é˜…ä¸‹é¢çš„ gif ä»¥æµ‹è¯•å•è¯ `hello`ï¼‰ã€‚

<div align=center><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/91a54f40c26a408ea1f015c9c41ae1d1~tplv-k3u1fbpfcp-zoom-1.image" width="40%" referrerpolicy="no-referrer"></div>

## ğŸ’¡ å‚è€ƒèµ„æ–™

- ğŸ† **å®æˆ˜æ•°æ®é›†ä¸‹è½½ï¼ˆç™¾åº¦ç½‘ç›˜ï¼‰**ï¼šå…¬ä¼—å·ã€ShowMeAIç ”ç©¶ä¸­å¿ƒã€å›å¤ã€**å®æˆ˜**ã€ï¼Œæˆ–è€…ç‚¹å‡» [**è¿™é‡Œ**](http://www.showmeai.tech/article-detail/305) è·å–æœ¬æ–‡ [[5] ä»0æ­å»ºåŸºäºç¥ç»ç½‘ç»œçš„æ‰‹è¯­è¯†åˆ«ç³»ç»Ÿ](http://www.showmeai.tech/article-detail/292)ã€**sign_mnist æ•°æ®é›†**ã€
- â­ **ShowMeAIå®˜æ–¹GitHub**ï¼š[https://github.com/ShowMeAI-Hub](https://github.com/ShowMeAI-Hub)
- ğŸ“˜ **æ·±åº¦å­¦ä¹ æ•™ç¨‹ | å´æ©è¾¾ä¸“é¡¹è¯¾ç¨‹ Â· å…¨å¥—ç¬”è®°è§£è¯»**: [http://www.showmeai.tech/tutorials/35](http://www.showmeai.tech/tutorials/35)
- ğŸ“˜ **å·ç§¯ç¥ç»ç½‘ç»œè§£è¯»**: [http://www.showmeai.tech/article-detail/221](http://www.showmeai.tech/article-detail/221)
- ğŸ“˜ **æ·±åº¦å­¦ä¹ çš„å®ç”¨å±‚é¢**: [http://www.showmeai.tech/article-detail/216](http://www.showmeai.tech/article-detail/216)
- ğŸ“˜ **ç»å…¸CNNç½‘ç»œå®ä¾‹è¯¦è§£**: [http://www.showmeai.tech/article-detail/222](http://www.showmeai.tech/article-detail/222)
- ğŸ“˜ **æ·±åº¦å­¦ä¹ ä¸è®¡ç®—æœºè§†è§‰æ•™ç¨‹**: [http://www.showmeai.tech/tutorials/37](http://www.showmeai.tech/tutorials/37)
- ğŸ“˜ **å·ç§¯ç¥ç»ç½‘ç»œè¯¦è§£**: [http://www.showmeai.tech/article-detail/264](http://www.showmeai.tech/article-detail/264)
- ğŸ“˜ **Tensorflow é€ŸæŸ¥æ‰‹å†Œ**: [http://www.showmeai.tech/article-detail/109](http://www.showmeai.tech/article-detail/109)
- ğŸ“˜ **OpenCV é€ŸæŸ¥è¡¨æ‰‹å†Œ**: [http://www.showmeai.tech/article-detail/112](http://www.showmeai.tech/article-detail/112)
- ğŸ“˜ **Numpy é€ŸæŸ¥æ‰‹å†Œ**: [http://www.showmeai.tech/article-detail/100](http://www.showmeai.tech/article-detail/100)
- ğŸ“˜ **Matplotlib é€ŸæŸ¥æ‰‹å†Œ**: [http://www.showmeai.tech/article-detail/103](http://www.showmeai.tech/article-detail/103)
- ğŸ“˜ [https://arxiv.org/ftp/arxiv/papers/1905/1905.05487.pdf](https://arxiv.org/ftp/arxiv/papers/1905/1905.05487.pdf)
- ğŸ“˜ [https://www.analyticsvidhya.com/blog/2021/06/sign-language-recognition-for-computer-vision-enthusiasts](https://www.analyticsvidhya.com/blog/2021/06/sign-language-recognition-for-computer-vision-enthusiasts/)


<a href="https://www.showmeai.tech/"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9190f41b8de4af38c8a1a0c96f0513b~tplv-k3u1fbpfcp-zoom-1.image" width="100%" referrerpolicy="no-referrer"></a>

> æˆ‘æ­£åœ¨å‚ä¸æ˜é‡‘æŠ€æœ¯ç¤¾åŒºåˆ›ä½œè€…ç­¾çº¦è®¡åˆ’æ‹›å‹Ÿæ´»åŠ¨ï¼Œ[ç‚¹å‡»é“¾æ¥æŠ¥åæŠ•ç¨¿](https://juejin.cn/post/7112770927082864653)ã€‚
