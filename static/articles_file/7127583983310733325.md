 æˆ‘æ­£åœ¨å‚åŠ ã€Œåˆ›æ„å¼€å‘ æŠ•ç¨¿å¤§èµ›ã€è¯¦æƒ…è¯·çœ‹ï¼š[æ˜é‡‘åˆ›æ„å¼€å‘å¤§èµ›æ¥äº†ï¼](https://juejin.cn/post/7120441631530549284) 

# ä¸€ã€åŸºäºPaddleGANç²¾å‡†å”‡å½¢åˆæˆæ¨¡å‹å®ç°ç¾å¥³è¡¨ç™½è§†é¢‘





## 1. PaddleGANçš„å”‡å½¢è¿ç§»èƒ½åŠ›--Wav2lip
**é“›é“›é“›ï¼ï¼é£æ¡¨[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)è¿™å°±æ¥ç»™å¤§å®¶æ­ç§˜ï¼Œæ‰‹æŠŠæ‰‹æ•™å¤§å®¶å¦‚ä½•å®ç°å”‡å‹çš„è¿ç§»ï¼Œå­¦ä¹ è¿‡æœ¬é¡¹ç›®çš„ä½ ä»¬ï¼Œä»æ­¤ä¸ä»…èƒ½è®©è‹è½¼å¿µè¯—ï¼Œè¿˜èƒ½è®©è’™å¨œä¸½èæ’­æ–°é—»ã€æ–°é—»ä¸»æ’­å”±Rap... åªæœ‰ä½ æƒ³ä¸åˆ°çš„ï¼Œæ²¡æœ‰[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)åšä¸åˆ°çš„ï¼**

æœ¬æ•™ç¨‹æ˜¯åŸºäº[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)å®ç°çš„è§†é¢‘å”‡å½¢åŒæ­¥æ¨¡å‹**Wav2lip**, å®ƒå®ç°äº†äººç‰©å£å‹ä¸è¾“å…¥è¯­éŸ³åŒæ­¥ï¼Œä¿—ç§°ã€Œå¯¹å£å‹ã€ã€‚ æ¯”å¦‚è¿™æ ·ï¼š



```
<iframe  width="1200" height="800" src="//player.bilibili.com/player.html?aid=848895487&bvid=BV1wL4y1q7Mb&cid=435817783&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
```



**ä¸ä»…ä»…è®©é™æ€å›¾åƒä¼šã€Œè¯´è¯ã€ï¼ŒWav2lipè¿˜å¯ä»¥ç›´æ¥å°†åŠ¨æ€çš„è§†é¢‘ï¼Œè¿›è¡Œå”‡å½¢è½¬æ¢ï¼Œè¾“å‡ºä¸ç›®æ ‡è¯­éŸ³ç›¸åŒ¹é…çš„è§†é¢‘ï¼Œè‡ªåˆ¶è§†é¢‘é…éŸ³ä¸æ˜¯æ¢¦ï¼**



**è‹¥æ˜¯å¤§å®¶å–œæ¬¢è¿™ä¸ªæ•™ç¨‹ï¼Œæ¬¢è¿åˆ°[Github PaddleGANä¸»é¡µ](https://github.com/PaddlePaddle/PaddleGAN)ç‚¹å‡»starå‘€ï¼ä¸‹é¢å°±è®©æˆ‘ä»¬ä¸€èµ·åŠ¨æ‰‹å®ç°å§ï¼**
<div align='left'>
  <img src='https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7ce273ee34a4217bd6d959dafa050da~tplv-k3u1fbpfcp-zoom-1.image' width='1000'/>
</div>



## 2.Wav2lipæ¨¡å‹åŸç†
Wav2lipå®ç°å”‡å½¢ä¸è¯­éŸ³ç²¾å‡†åŒæ­¥çªç ´çš„å…³é”®åœ¨äºï¼Œå®ƒé‡‡ç”¨äº†**å”‡å½¢åŒæ­¥åˆ¤åˆ«å™¨ï¼Œä»¥å¼ºåˆ¶ç”Ÿæˆå™¨æŒç»­äº§ç”Ÿå‡†ç¡®è€Œé€¼çœŸçš„å”‡éƒ¨è¿åŠ¨ã€‚**

æ­¤å¤–ï¼Œè¯¥ç ”ç©¶é€šè¿‡åœ¨é‰´åˆ«å™¨ä¸­ï¼Œä½¿ç”¨**å¤šä¸ªè¿ç»­å¸§è€Œä¸æ˜¯å•ä¸ªå¸§ï¼Œå¹¶ä½¿ç”¨è§†è§‰è´¨é‡æŸå¤±ï¼ˆè€Œä¸ä»…ä»…æ˜¯å¯¹æ¯”æŸå¤±ï¼‰æ¥è€ƒè™‘æ—¶é—´ç›¸å…³æ€§ï¼Œä»è€Œæ”¹å–„äº†è§†è§‰è´¨é‡ã€‚**

è¯¥wav2lipæ¨¡å‹å‡ ä¹æ˜¯**ä¸‡èƒ½**çš„ï¼Œé€‚ç”¨äºä»»ä½•**äººè„¸**ã€**ä»»ä½•è¯­éŸ³**ã€**ä»»ä½•è¯­è¨€**ï¼Œå¯¹ä»»æ„è§†é¢‘éƒ½èƒ½è¾¾åˆ°å¾ˆé«˜çš„å‡†ç¡®ç‡ï¼Œå¯ä»¥æ— ç¼åœ°ä¸åŸå§‹è§†é¢‘èåˆï¼Œè¿˜å¯ä»¥ç”¨äº**è½¬æ¢åŠ¨ç”»äººè„¸ï¼Œå¹¶ä¸”å¯¼å…¥åˆæˆè¯­éŸ³**ä¹Ÿæ˜¯å¯è¡Œçš„

# äºŒã€ç¯å¢ƒå‡†å¤‡

## 1.ä¸‹è½½PaddleGANä»£ç 


```python
# ä»githubä¸Šå…‹éš†PaddleGANä»£ç ï¼ˆå¦‚ä¸‹è½½é€Ÿåº¦è¿‡æ…¢ï¼Œå¯ç”¨giteeæºï¼‰
!git clone https://gitee.com/PaddlePaddle/PaddleGAN
#!git clone https://github.com/PaddlePaddle/PaddleGAN
```

    Cloning into 'PaddleGAN'...
    remote: Enumerating objects: 565, done.[K
    remote: Counting objects: 100% (565/565), done.[K
    remote: Compressing objects: 100% (315/315), done.[K
    remote: Total 3944 (delta 326), reused 459 (delta 235), pack-reused 3379[K
    Receiving objects: 100% (3944/3944), 161.95 MiB | 25.73 MiB/s, done.
    Resolving deltas: 100% (2534/2534), done.
    Checking connectivity... done.


## 2.å®‰è£…sndfileã€libsndfile


```python
# å®‰è£…æ‰€éœ€å®‰è£…åŒ…
!mkdir sndfile
%cd ~/sndfile
!wget http://www.mega-nerd.com/libsndfile/files/libsndfile-1.0.28.tar.gz
!tar xzvf libsndfile-1.0.28.tar.gz

%cd libsndfile-1.0.28
!./configure --prefix=/home/aistudio/build_libs CFLAGS=-fPIC --enable-shared 
!make
!make install
```

## 3.å®‰è£…PaddleGAN


```python
%cd ~/PaddleGAN
!pip install -r requirements.txt
!pip install -e .
%cd applications/
```

# ä¸‰ã€æ•°æ®å‡†å¤‡

## 1.å£°éŸ³å‡†å¤‡
é€‰å–æŠ–éŸ³é‡Œå¾—è§†é¢‘ï¼Œé€šè¿‡ffmpæå–å£°éŸ³

```
 !ffmpeg -i 1.mp4 -f s16le -ar 16000 1.wav
```




```python
%cd ~
!ffmpeg -i  1.mp4 -vn -codec copy 1.m4a
```

    /home/aistudio
    ffmpeg version 2.8.15-0ubuntu0.16.04.1 Copyright (c) 2000-2018 the FFmpeg developers
      built with gcc 5.4.0 (Ubuntu 5.4.0-6ubuntu1~16.04.10) 20160609
      configuration: --prefix=/usr --extra-version=0ubuntu0.16.04.1 --build-suffix=-ffmpeg --toolchain=hardened --libdir=/usr/lib/x86_64-linux-gnu --incdir=/usr/include/x86_64-linux-gnu --cc=cc --cxx=g++ --enable-gpl --enable-shared --disable-stripping --disable-decoder=libopenjpeg --disable-decoder=libschroedinger --enable-avresample --enable-avisynth --enable-gnutls --enable-ladspa --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libflite --enable-libfontconfig --enable-libfreetype --enable-libfribidi --enable-libgme --enable-libgsm --enable-libmodplug --enable-libmp3lame --enable-libopenjpeg --enable-libopus --enable-libpulse --enable-librtmp --enable-libschroedinger --enable-libshine --enable-libsnappy --enable-libsoxr --enable-libspeex --enable-libssh --enable-libtheora --enable-libtwolame --enable-libvorbis --enable-libvpx --enable-libwavpack --enable-libwebp --enable-libx265 --enable-libxvid --enable-libzvbi --enable-openal --enable-opengl --enable-x11grab --enable-libdc1394 --enable-libiec61883 --enable-libzmq --enable-frei0r --enable-libx264 --enable-libopencv
      libavutil      54. 31.100 / 54. 31.100
      libavcodec     56. 60.100 / 56. 60.100
      libavformat    56. 40.101 / 56. 40.101
      libavdevice    56.  4.100 / 56.  4.100
      libavfilter     5. 40.101 /  5. 40.101
      libavresample   2.  1.  0 /  2.  1.  0
      libswscale      3.  1.101 /  3.  1.101
      libswresample   1.  2.101 /  1.  2.101
      libpostproc    53.  3.100 / 53.  3.100
    Input #0, mov,mp4,m4a,3gp,3g2,mj2, from '1.mp4':
      Metadata:
        major_brand     : isom
        minor_version   : 512
        compatible_brands: isomiso2avc1mp41
        encoder         : Lavf58.12.100
      Duration: 00:00:06.63, start: 0.000000, bitrate: 1437 kb/s
        Stream #0:0(und): Video: h264 (High) (avc1 / 0x31637661), yuv420p(tv, smpte170m/bt470bg/smpte170m), 720x1280 [SAR 1:1 DAR 9:16], 1300 kb/s, 29.85 fps, 30 tbr, 10000k tbn, 60 tbc (default)
        Metadata:
          handler_name    : VideoHandler
        Stream #0:1(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 128 kb/s (default)
        Metadata:
          handler_name    : SoundHandler
    [1;35m[ipod @ 0xa63720] [0m[0;33mCodec for stream 0 does not use global headers but container format requires global headers
    [0mOutput #0, ipod, to '1.m4a':
      Metadata:
        major_brand     : isom
        minor_version   : 512
        compatible_brands: isomiso2avc1mp41
        encoder         : Lavf56.40.101
        Stream #0:0(und): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, 128 kb/s (default)
        Metadata:
          handler_name    : SoundHandler
    Stream mapping:
      Stream #0:1 -> #0:0 (copy)
    Press [q] to stop, [?] for help
    size=     104kB time=00:00:06.54 bitrate= 130.3kbits/s    
    video:0kB audio:102kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 1.781061%


## 2.å›¾ç‰‡æˆ–è§†é¢‘
éšæœºç½‘ä¸Šç™¾åº¦å¡é€šç¾å¥³ç…§ç‰‡ä¸€å¼ 


```python
from PIL import Image
img=Image.open('1.jpg')
img
```





![360æˆªå›¾20220803191040035.jpg](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e5f5893a1544dfabd6094b1a25b12fa~tplv-k3u1fbpfcp-watermark.image?)



# å››ã€ä½¿ç”¨æ¨¡å‹è¿›è¡Œåˆæˆ
## 1.å”‡å½¢åŠ¨ä½œåˆæˆå‘½ä»¤ä½¿ç”¨è¯´æ˜

é‡ç‚¹æ¥å•¦ï¼ï¼æœ¬é¡¹ç›®æ”¯æŒå¤§å®¶ä¸Šä¼ è‡ªå·±å‡†å¤‡çš„è§†é¢‘å’ŒéŸ³é¢‘ï¼Œ åˆæˆä»»æ„æƒ³è¦çš„**é€¼çœŸçš„é…éŸ³è§†é¢‘**ï¼ï¼![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0ac3a25d89442f880b5c34c58d075e2~tplv-k3u1fbpfcp-zoom-1.image)



åªéœ€åœ¨å¦‚ä¸‹å‘½ä»¤ä¸­çš„**faceå‚æ•°**å’Œ**audioå‚æ•°**åˆ†åˆ«æ¢æˆè‡ªå·±çš„è§†é¢‘å’ŒéŸ³é¢‘è·¯å¾„ï¼Œç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°±å¯ä»¥ç”Ÿæˆå’ŒéŸ³é¢‘åŒæ­¥çš„è§†é¢‘ã€‚

ç¨‹åºè¿è¡Œå®Œæˆåï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆæ–‡ä»¶åä¸º**outfile**å‚æ•°æŒ‡å®šçš„è§†é¢‘æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å³ä¸ºå’ŒéŸ³é¢‘åŒæ­¥çš„è§†é¢‘æ–‡ä»¶ã€‚æœ¬é¡¹ç›®ä¸­æä¾›äº†demoå±•ç¤ºæ‰€ç”¨åˆ°çš„è§†é¢‘å’ŒéŸ³é¢‘æ–‡ä»¶ã€‚å…·ä½“çš„å‚æ•°ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š
- face: åŸå§‹è§†é¢‘ï¼Œè§†é¢‘ä¸­çš„äººç‰©çš„å”‡å½¢å°†æ ¹æ®éŸ³é¢‘è¿›è¡Œå”‡å½¢åˆæˆ--é€šä¿—æ¥è¯´ï¼Œæƒ³è®©è°è¯´è¯
- audioï¼šé©±åŠ¨å”‡å½¢åˆæˆçš„éŸ³é¢‘ï¼Œè§†é¢‘ä¸­çš„äººç‰©å°†æ ¹æ®æ­¤éŸ³é¢‘è¿›è¡Œå”‡å½¢åˆæˆ--é€šä¿—æ¥è¯´ï¼Œæƒ³è®©è¿™ä¸ªäººè¯´ä»€ä¹ˆ

## 2.numbaé™çº§

numbaæŠ¥é”™ï¼Œéœ€è¦å¯¹numbaè¿›è¡Œé™çº§,ä½†æ˜¯requirements.txté‡Œä¸º **numba==0.53.1**
```
 File "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/librosa/util/utils.py", line 15, in <module>
    from .decorators import deprecated
  File "/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/librosa/util/decorators.py", line 9, in <module>
    from numba.decorators import jit as optional_jit
ModuleNotFoundError: No module named 'numba.decorators'
```


```python
!pip uninstall numba -y
!pip install numba==0.48.0 --user
```

æç¤º
```
ERROR: ppgan 2.0.0 has requirement numba==0.53.1, but you'll have numba 0.48.0 which is incompatible.
Installing collected packages: numba
Successfully installed numba-0.48.0
```
ä½†æ˜¯é»˜è®¤é«˜ç‰ˆæœ¬å°±æŠ¥ `ModuleNotFoundError: No module named 'numba.decorators'`


```python
!pip list|grep numba
```

## 3.è§†é¢‘åˆæˆ


```python
%cd /home/aistudio/PaddleGAN/applications/
!export PYTHONPATH=$PYTHONPATH:/home/aistudio/work/PaddleGAN && python tools/wav2lip.py --face /home/aistudio/1.jpg --audio /home/aistudio/1.m4a --outfile /home/aistudio/bb.mp4
```

## 4.æˆæœå±•ç¤º

**è§†é¢‘æ¯”è¾ƒé•¿çš„è¯ï¼Œè¿è¡Œæ—¶é—´ä¼šç¨é•¿ï¼Œå»ºè®®æŠŠè§†é¢‘ä¸‹è½½åˆ°æœ¬åœ°é¢„è§ˆ**


<iframe  width="800" height="600" src="//player.bilibili.com/player.html?aid=848895487&bvid=BV1wL4y1q7Mb&cid=435817783&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>


# äº”ã€æ€»ç»“
**é¦–å…ˆå¸®å¤§å®¶æ€»ç»“ä¸€æ³¢ï¼šè®©å›¾ç‰‡ä¼šè¯´è¯ã€è§†é¢‘èŠ±å¼é…éŸ³çš„é­”æ³•--Wav2lipçš„ä½¿ç”¨åªç”¨ä¸‰æ­¥**ï¼š
1. ç¯å¢ƒå‡†å¤‡ï¼šå®‰è£…Paddleç¯å¢ƒå¹¶ä¸‹è½½[PaddleGAN](https://github.com/PaddlePaddle/PaddleGAN)
2. ç´ æå‡†å¤‡ï¼šé€‰æ‹©ï¼ˆæŠ“å–æˆ–å½•åˆ¶ï¼‰æƒ³è¦ã€Œé…éŸ³/å¯¹å£å‹ã€çš„å¯¹è±¡ä»¥åŠéŸ³é¢‘å†…å®¹
3. è¿è¡Œä»£ç ï¼šè¿è¡Œä»£ç å¹¶ä¿å­˜åˆ¶ä½œå®Œæˆçš„å¯¹å£å‹è§†é¢‘åˆ†äº«æƒŠè‰³ä¼—äºº

