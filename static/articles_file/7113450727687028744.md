æœ¬æ–‡å·²å‚ä¸ã€Œæ–°äººåˆ›ä½œç¤¼ã€æ´»åŠ¨,ä¸€èµ·å¼€å¯æ˜é‡‘åˆ›ä½œä¹‹è·¯ã€‚
## ä¼šè¯æŠ€æœ¯
**ä¼šè¯**ï¼šä¸€æ¬¡ä¼šè¯ä¸­åŒ…å«å¤šæ¬¡è¯·æ±‚å’Œå“åº”ã€‚

- ä¸€æ¬¡ä¼šè¯ï¼šæµè§ˆå™¨ç¬¬ä¸€æ¬¡ç»™æœåŠ¡å™¨èµ„æºå‘é€è¯·æ±‚ï¼Œä¼šè¯å»ºç«‹ï¼Œç›´åˆ°æœ‰ä¸€æ–¹æ–­å¼€ä¸ºæ­¢
åŠŸèƒ½ï¼šåœ¨ä¸€æ¬¡ä¼šè¯çš„èŒƒå›´å†…çš„å¤šæ¬¡è¯·æ±‚é—´ï¼Œå…±äº«æ•°æ®
æ–¹å¼ï¼š
- å®¢æˆ·ç«¯ä¼šè¯æŠ€æœ¯ï¼šCookie
- æœåŠ¡å™¨ç«¯ä¼šè¯æŠ€æœ¯ï¼šSession
## Cookie
### æ¦‚å¿µ
å®¢æˆ·ç«¯ä¼šè¯æŠ€æœ¯ï¼Œå°†æ•°æ®ä¿å­˜åˆ°å®¢æˆ·ç«¯
### å¿«é€Ÿå…¥é—¨
ä½¿ç”¨æ­¥éª¤ï¼š

1. åˆ›å»ºCookieå¯¹è±¡ï¼Œç»‘å®šæ•°æ®
new Cookie(String name, String value)
1. å‘é€Cookieå¯¹è±¡
response.addCookie(Cookie cookie)
1. è·å–Cookieï¼Œæ‹¿åˆ°æ•°æ®
Cookie[] Â request.getCookies()
### å®ç°åŸç†
åŸºäºå“åº”å¤´set-cookieå’Œè¯·æ±‚å¤´cookieå®ç°
### cookieçš„ç»†èŠ‚

1. ä¸€æ¬¡å¯ä¸å¯ä»¥å‘é€å¤šä¸ªcookie?
å¯ä»¥åˆ›å»ºå¤šä¸ªCookieå¯¹è±¡ï¼Œä½¿ç”¨responseè°ƒç”¨å¤šæ¬¡addCookieæ–¹æ³•å‘é€cookieå³å¯ã€‚
1. cookieåœ¨æµè§ˆå™¨ä¸­ä¿å­˜å¤šé•¿æ—¶é—´ï¼Ÿ
- é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“æµè§ˆå™¨å…³é—­åï¼ŒCookieæ•°æ®è¢«é”€æ¯
- æŒä¹…åŒ–å­˜å‚¨ï¼š
`setMaxAge(int seconds)`
- æ­£æ•°ï¼šå°†Cookieæ•°æ®å†™åˆ°ç¡¬ç›˜çš„æ–‡ä»¶ä¸­ã€‚æŒä¹…åŒ–å­˜å‚¨ã€‚å¹¶æŒ‡å®šcookieå­˜æ´»æ—¶é—´ï¼Œæ—¶é—´åˆ°åï¼Œcookieæ–‡ä»¶è‡ªåŠ¨å¤±æ•ˆ
- è´Ÿæ•°ï¼šé»˜è®¤å€¼
- é›¶ï¼šåˆ é™¤cookieä¿¡æ¯
3. cookieèƒ½ä¸èƒ½å­˜ä¸­æ–‡ï¼Ÿ
åœ¨tomcat 8 ä¹‹å‰ cookieä¸­ä¸èƒ½ç›´æ¥å­˜å‚¨ä¸­æ–‡æ•°æ®ã€‚
- éœ€è¦å°†ä¸­æ–‡æ•°æ®è½¬ç ---ä¸€èˆ¬é‡‡ç”¨URLç¼–ç (%E3)
åœ¨tomcat 8 ä¹‹åï¼Œcookieæ”¯æŒä¸­æ–‡æ•°æ®ã€‚ç‰¹æ®Šå­—ç¬¦è¿˜æ˜¯ä¸æ”¯æŒï¼Œå»ºè®®ä½¿ç”¨URLç¼–ç å­˜å‚¨ï¼ŒURLè§£ç è§£æ
4. cookieå…±äº«é—®é¢˜ï¼Ÿ
4. å‡è®¾åœ¨ä¸€ä¸ªtomcatæœåŠ¡å™¨ä¸­ï¼Œéƒ¨ç½²äº†å¤šä¸ªwebé¡¹ç›®ï¼Œé‚£ä¹ˆåœ¨è¿™äº›webé¡¹ç›®ä¸­cookieèƒ½ä¸èƒ½å…±äº«ï¼Ÿ
-  é»˜è®¤æƒ…å†µä¸‹cookieä¸èƒ½å…±äº« 
-  setPath(String path):è®¾ç½®cookieçš„è·å–èŒƒå›´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè®¾ç½®å½“å‰çš„è™šæ‹Ÿç›®å½• 
   - å¦‚æœè¦å…±äº«ï¼Œåˆ™å¯ä»¥å°†pathè®¾ç½®ä¸º"/"
2. ä¸åŒçš„tomcatæœåŠ¡å™¨é—´cookieå…±äº«é—®é¢˜ï¼Ÿ
`setDomain(String path)`:å¦‚æœè®¾ç½®ä¸€çº§åŸŸåç›¸åŒï¼Œé‚£ä¹ˆå¤šä¸ªæœåŠ¡å™¨ä¹‹é—´cookieå¯ä»¥å…±äº«
`setDomain(".baidu.com")`,é‚£ä¹ˆtieba.baidu.comå’Œnews.baidu.comä¸­cookieå¯ä»¥å…±äº«
### Cookieçš„ç‰¹ç‚¹å’Œä½œç”¨

1. cookieå­˜å‚¨æ•°æ®åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨
1. æµè§ˆå™¨å¯¹äºå•ä¸ªcookie çš„å¤§å°æœ‰é™åˆ¶(4kb) ä»¥åŠ å¯¹åŒä¸€ä¸ªåŸŸåä¸‹çš„æ€»cookieæ•°é‡ä¹Ÿæœ‰é™åˆ¶(20ä¸ª)

ä½œç”¨ï¼š

1. cookieä¸€èˆ¬ç”¨äºå­˜å‡ºå°‘é‡çš„ä¸å¤ªæ•æ„Ÿçš„æ•°æ®
1. åœ¨ä¸ç™»å½•çš„æƒ…å†µä¸‹ï¼Œå®ŒæˆæœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„èº«ä»½è¯†åˆ«
### æ¡ˆä¾‹ï¼šè®°ä½ä¸Šä¸€æ¬¡è®¿é—®æ—¶é—´
#### éœ€æ±‚

1. è®¿é—®ä¸€ä¸ªServletï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œåˆ™æç¤ºï¼šæ‚¨å¥½ï¼Œæ¬¢è¿æ‚¨é¦–æ¬¡è®¿é—®ã€‚
1. å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œåˆ™æç¤ºï¼šæ¬¢è¿å›æ¥ï¼Œæ‚¨ä¸Šæ¬¡è®¿é—®æ—¶é—´ä¸º:æ˜¾ç¤ºæ—¶é—´å­—ç¬¦ä¸²
#### åˆ†æ

1. å¯ä»¥é‡‡ç”¨Cookieæ¥å®Œæˆ
1. åœ¨æœåŠ¡å™¨ä¸­çš„Servletåˆ¤æ–­æ˜¯å¦æœ‰ä¸€ä¸ªåä¸ºlastTimeçš„cookie
- æœ‰ï¼šä¸æ˜¯ç¬¬ä¸€æ¬¡è®¿é—® 
   - å“åº”æ•°æ®ï¼šæ¬¢è¿å›æ¥ï¼Œæ‚¨ä¸Šæ¬¡è®¿é—®æ—¶é—´ä¸º:2022å¹´5æœˆ1æ—¥08:08:08
   - å†™å›Cookieï¼šlastTime=2022å¹´5æœˆ1æ—¥08:08:08
- æ²¡æœ‰ï¼šæ˜¯ç¬¬ä¸€æ¬¡è®¿é—® 
   - å“åº”æ•°æ®ï¼šæ‚¨å¥½ï¼Œæ¬¢è¿æ‚¨é¦–æ¬¡è®¿é—®
   - å†™å›Cookieï¼šlastTime=2022å¹´5æœˆ1æ—¥08:08:08
#### ä»£ç å®ç°
```java
package cn.zjq.cookie;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.net.URLDecoder;
import java.net.URLEncoder;
import java.text.SimpleDateFormat;
import java.util.Date;


@WebServlet("/cookieTest")
public class CookieTest extends HttpServlet {
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	//è®¾ç½®å“åº”çš„æ¶ˆæ¯ä½“çš„æ•°æ®æ ¼å¼ä»¥åŠç¼–ç 
	response.setContentType("text/html;charset=utf-8");

	//1.è·å–æ‰€æœ‰Cookie
	Cookie[] cookies = request.getCookies();
	boolean flag = false;//æ²¡æœ‰cookieä¸ºlastTime
	//2.éå†cookieæ•°ç»„
	if(cookies != null && cookies.length > 0){
		for (Cookie cookie : cookies) {
			//3.è·å–cookieçš„åç§°
			String name = cookie.getName();
			//4.åˆ¤æ–­åç§°æ˜¯å¦æ˜¯ï¼šlastTime
			if("lastTime".equals(name)){
				//æœ‰è¯¥Cookieï¼Œä¸æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®

				flag = true;//æœ‰lastTimeçš„cookie

				//è®¾ç½®Cookieçš„value
				//è·å–å½“å‰æ—¶é—´çš„å­—ç¬¦ä¸²ï¼Œé‡æ–°è®¾ç½®Cookieçš„å€¼ï¼Œé‡æ–°å‘é€cookie
				Date date  = new Date();
				SimpleDateFormat sdf = new SimpleDateFormat("yyyyå¹´MMæœˆddæ—¥ HH:mm:ss");
				String str_date = sdf.format(date);
				System.out.println("ç¼–ç å‰ï¼š"+str_date);
				//URLç¼–ç 
				str_date = URLEncoder.encode(str_date,"utf-8");
				System.out.println("ç¼–ç åï¼š"+str_date);
				cookie.setValue(str_date);
				//è®¾ç½®cookieçš„å­˜æ´»æ—¶é—´
				cookie.setMaxAge(60 * 60 * 24 * 30);//ä¸€ä¸ªæœˆ
				response.addCookie(cookie);


				//å“åº”æ•°æ®
				//è·å–Cookieçš„valueï¼Œæ—¶é—´
				String value = cookie.getValue();
				System.out.println("è§£ç å‰ï¼š"+value);
				//URLè§£ç ï¼š
				value = URLDecoder.decode(value,"utf-8");
				System.out.println("è§£ç åï¼š"+value);
				response.getWriter().write("<h1>æ¬¢è¿å›æ¥ï¼Œæ‚¨ä¸Šæ¬¡è®¿é—®æ—¶é—´ä¸º:"+value+"</h1>");

				break;

			}
		}
	}


	if(cookies == null || cookies.length == 0 || flag == false){
		//æ²¡æœ‰ï¼Œç¬¬ä¸€æ¬¡è®¿é—®

		//è®¾ç½®Cookieçš„value
		//è·å–å½“å‰æ—¶é—´çš„å­—ç¬¦ä¸²ï¼Œé‡æ–°è®¾ç½®Cookieçš„å€¼ï¼Œé‡æ–°å‘é€cookie
		Date date  = new Date();
		SimpleDateFormat sdf = new SimpleDateFormat("yyyyå¹´MMæœˆddæ—¥ HH:mm:ss");
		String str_date = sdf.format(date);
		System.out.println("ç¼–ç å‰ï¼š"+str_date);
		//URLç¼–ç 
		str_date = URLEncoder.encode(str_date,"utf-8");
		System.out.println("ç¼–ç åï¼š"+str_date);

		Cookie cookie = new Cookie("lastTime",str_date);
		//è®¾ç½®cookieçš„å­˜æ´»æ—¶é—´
		cookie.setMaxAge(60 * 60 * 24 * 30);//ä¸€ä¸ªæœˆ
		response.addCookie(cookie);

		response.getWriter().write("<h1>æ‚¨å¥½ï¼Œæ¬¢è¿æ‚¨é¦–æ¬¡è®¿é—®</h1>");
	}


}

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		this.doPost(request, response);
	}
}
```
## Session
### æ¦‚å¿µ
æœåŠ¡å™¨ç«¯ä¼šè¯æŠ€æœ¯ï¼Œåœ¨ä¸€æ¬¡ä¼šè¯çš„å¤šæ¬¡è¯·æ±‚é—´å…±äº«æ•°æ®ï¼Œå°†æ•°æ®ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯çš„å¯¹è±¡ä¸­ã€‚HttpSession
### å¿«é€Ÿå…¥é—¨

1. è·å–HttpSessionå¯¹è±¡ï¼š
HttpSession session = request.getSession();
1. ä½¿ç”¨HttpSessionå¯¹è±¡ï¼š
Object getAttribute(String name)
void setAttribute(String name, Object value)
void removeAttribute(String name)
### åŸç†
Sessionçš„å®ç°æ˜¯ä¾èµ–äºCookieçš„ã€‚
### ç»†èŠ‚

1. å½“å®¢æˆ·ç«¯å…³é—­åï¼ŒæœåŠ¡å™¨ä¸å…³é—­ï¼Œä¸¤æ¬¡è·å–sessionæ˜¯å¦ä¸ºåŒä¸€ä¸ªï¼Ÿ
é»˜è®¤æƒ…å†µä¸‹ã€‚ä¸æ˜¯ã€‚
å¦‚æœéœ€è¦ç›¸åŒï¼Œåˆ™å¯ä»¥åˆ›å»ºCookie,é”®ä¸ºJSESSIONIDï¼Œè®¾ç½®æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œè®©cookieæŒä¹…åŒ–ä¿å­˜ã€‚
```java
Cookie c = new Cookie("JSESSIONID",session.getId());
c.setMaxAge(60*60);
response.addCookie(c);
```

2. å®¢æˆ·ç«¯ä¸å…³é—­ï¼ŒæœåŠ¡å™¨å…³é—­åï¼Œä¸¤æ¬¡è·å–çš„sessionæ˜¯åŒä¸€ä¸ªå—ï¼Ÿ
ä¸æ˜¯åŒä¸€ä¸ªï¼Œä½†æ˜¯è¦ç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ã€‚tomcatè‡ªåŠ¨å®Œæˆä»¥ä¸‹å·¥ä½œ
- sessionçš„é’åŒ–ï¼š 
   - åœ¨æœåŠ¡å™¨æ­£å¸¸å…³é—­ä¹‹å‰ï¼Œå°†sessionå¯¹è±¡ç³»åˆ—åŒ–åˆ°ç¡¬ç›˜ä¸Š
- sessionçš„æ´»åŒ–ï¼š 
   - åœ¨æœåŠ¡å™¨å¯åŠ¨åï¼Œå°†sessionæ–‡ä»¶è½¬åŒ–ä¸ºå†…å­˜ä¸­çš„sessionå¯¹è±¡å³å¯ã€‚
3. sessionä»€ä¹ˆæ—¶å€™è¢«é”€æ¯ï¼Ÿ
- æœåŠ¡å™¨å…³é—­
- sessionå¯¹è±¡è°ƒç”¨invalidate() ã€‚
- sessioné»˜è®¤å¤±æ•ˆæ—¶é—´ 30åˆ†é’Ÿ
é€‰æ‹©æ€§é…ç½®ä¿®æ”¹
```xml
<session-config>
	<session-timeout>30</session-timeout>
</session-config>
```
### Sessionçš„ç‰¹ç‚¹

1. Sessionç”¨äºå­˜å‚¨ä¸€æ¬¡ä¼šè¯çš„å¤šæ¬¡è¯·æ±‚çš„æ•°æ®ï¼Œå­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚
1. Sessionå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹ï¼Œä»»æ„å¤§å°çš„æ•°æ®ã€‚
### Sessionä¸Cookieçš„åŒºåˆ«

1. Sessionå­˜å‚¨æ•°æ®åœ¨æœåŠ¡å™¨ç«¯ï¼ŒCookieåœ¨å®¢æˆ·ç«¯
1. Sessionæ²¡æœ‰æ•°æ®å¤§å°é™åˆ¶ï¼ŒCookieæœ‰
1. Sessionæ•°æ®å®‰å…¨ï¼ŒCookieç›¸å¯¹äºä¸å®‰å…¨

>æœ¬æ–‡å†…å®¹åˆ°æ­¤ç»“æŸäº†ï¼Œ
>
> å¦‚æœ‰æ”¶è·æ¬¢è¿ç‚¹èµğŸ‘æ”¶è—ğŸ’–å…³æ³¨âœ”ï¸ï¼Œæ‚¨çš„é¼“åŠ±æ˜¯æˆ‘æœ€å¤§çš„åŠ¨åŠ›ã€‚
>
> å¦‚æœ‰é”™è¯¯âŒç–‘é—®ğŸ’¬æ¬¢è¿å„ä½å¤§ä½¬æŒ‡å‡ºã€‚	
>
> **ä¸»é¡µ**ï¼š[å…±é¥®ä¸€æ¯æ— çš„åšå®¢æ±‡æ€»ğŸ‘¨â€ğŸ’»](https://juejin.cn/user/2506542241824007)
> 	
> **ä¿æŒçƒ­çˆ±ï¼Œå¥”èµ´ä¸‹ä¸€åœºå±±æµ·**ã€‚ğŸƒğŸƒğŸƒ

![a37032f76d3ebe77e3e3d265ff1e1d7.jpg](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fac313cfa82243ad9a2e287dceecc181~tplv-k3u1fbpfcp-zoom-1.image)
