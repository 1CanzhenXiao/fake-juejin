***
**æœ¬æ–‡é€‰è‡ªï¼š[ğŸ”—365å¤©æ·±åº¦å­¦ä¹ è®­ç»ƒè¥](https://mp.weixin.qq.com/s?__biz=MzUyNDgyNDkyMQ==&mid=2247488868&idx=1&sn=2d08e00e6e3d0d5d62b288008b53c55f&chksm=fa262d52cd51a444d771acb6d28f5edea434ba4173a7cf6057ab4a76fa2c0f49850479b35313&scene=18#wechat_redirect)** ï¼ˆ`å…è´¹è¾…å¯¼`ã€`å…è´¹å’¨è¯¢`ï¼‰
***

ä¸€å¥è¯ä»‹ç»LSTMï¼Œ**å®ƒæ˜¯RNNçš„è¿›é˜¶ç‰ˆï¼Œå¦‚æœè¯´RNNçš„æœ€å¤§é™åº¦æ˜¯ç†è§£ä¸€å¥è¯ï¼Œé‚£ä¹ˆLSTMçš„æœ€å¤§é™åº¦åˆ™æ˜¯ç†è§£ä¸€æ®µè¯**ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š

LSTMï¼Œå…¨ç§°ä¸ºé•¿çŸ­æœŸè®°å¿†ç½‘ç»œ(Long Short Term Memory networks)ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„RNNï¼Œèƒ½å¤Ÿå­¦ä¹ åˆ°é•¿æœŸä¾èµ–å…³ç³»ã€‚1997æå‡ºï¼Œè®¸å¤šç ”ç©¶è€…è¿›è¡Œäº†ä¸€ç³»åˆ—çš„å·¥ä½œå¯¹å…¶æ”¹è¿›å¹¶ä½¿ä¹‹å‘æ‰¬å…‰å¤§ã€‚LSTMåœ¨è®¸å¤šé—®é¢˜ä¸Šæ•ˆæœéå¸¸å¥½ï¼Œç°åœ¨è¢«å¹¿æ³›ä½¿ç”¨ã€‚

æ‰€æœ‰çš„å¾ªç¯ç¥ç»ç½‘ç»œéƒ½æœ‰ç€é‡å¤çš„ç¥ç»ç½‘ç»œæ¨¡å—å½¢æˆé“¾çš„å½¢å¼ã€‚åœ¨æ™®é€šçš„RNNä¸­ï¼Œé‡å¤æ¨¡å—ç»“æ„éå¸¸ç®€å•ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e09d66fcec754385a79408e61997e50d~tplv-k3u1fbpfcp-zoom-1.image)


LSTMé¿å…äº†é•¿æœŸä¾èµ–çš„é—®é¢˜ã€‚å¯ä»¥è®°ä½é•¿æœŸä¿¡æ¯ï¼LSTMå†…éƒ¨æœ‰è¾ƒä¸ºå¤æ‚çš„ç»“æ„ã€‚èƒ½é€šè¿‡é—¨æ§çŠ¶æ€æ¥é€‰æ‹©è°ƒæ•´ä¼ è¾“çš„ä¿¡æ¯ï¼Œ**è®°ä½éœ€è¦é•¿æ—¶é—´è®°å¿†çš„ä¿¡æ¯ï¼Œå¿˜è®°ä¸é‡è¦çš„ä¿¡æ¯**ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89be2501b20941108e8477dd266591ca~tplv-k3u1fbpfcp-zoom-1.image)
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8b3363201b244e8c828d5fd934e71f29~tplv-k3u1fbpfcp-zoom-1.image)

# ä¸€ã€LSTMçš„æ•°æ®å¤„ç†æµç¨‹
ä¸ºäº†æ›´å¥½çš„ç†è§£LSTMè¾“å…¥æ•°æ®çš„ç»“æ„ï¼Œæˆ‘å°†æ—¶åºæ•°æ®ï¼ˆLSTMè¾“å…¥æ•°æ®ï¼‰ä»¥å¯è§†åŒ–çš„å½¢å¼å‘ˆç°ã€‚
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f67e15e951f4b82882d62344848edbd~tplv-k3u1fbpfcp-zoom-1.image)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5eec179effad46818664c4422cbb32bc~tplv-k3u1fbpfcp-zoom-1.image)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/00a18111e3824230a7b44cd8ebfb6e5b~tplv-k3u1fbpfcp-zoom-1.image)

æ ¹æ®è¾“å…¥çš„æ•°æ®ç»“æ„ã€é¢„æµ‹è¾“å‡ºï¼Œæˆ‘ä»¬çš„ç¨‹åºå¯ä»¥å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å…­ç±»ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92770bd222b844c3a73330def89551c4~tplv-k3u1fbpfcp-zoom-1.image)
# äºŒã€å…³äºä»£ç å®ç°
## 1. å•è¾“å…¥å•è¾“å‡ºï¼ˆå•è¾“å‡ºæ—¶é—´æ­¥ï¼‰

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/63509fa909254d6ea7f59d76013ee205~tplv-k3u1fbpfcp-zoom-1.image)

- **è¾“å…¥ï¼šå•ä¸ªç‰¹å¾ï¼Œå¤šä¸ªæ—¶é—´æ­¥**
- **è¾“å‡ºï¼šå•ä¸ªç‰¹å¾ï¼Œå•ä¸ªæ—¶é—´æ­¥**

**ğŸ¥« æ•°æ®æ¡ˆä¾‹**

```python
è®­ç»ƒé›†ï¼š
X                         y
[10, 20, 30, 40, 50]      [60]
[20, 30, 40, 50, 60]      [70]
[30, 40, 50, 60, 70]      [80]
â€¦


é¢„æµ‹è¾“å…¥ï¼š
X
[70, 80, 90, 100 ,110]
æœŸå¾…è¾“å‡ºï¼š
y
[120]
```


**ğŸ¥  TensorFlow2ä»£ç å®ç°**

```python
model = Sequential()
model.add( LSTM(50,  activation='relu',  input_shape = (n_steps, n_features)) )
model.add( Dense(1) )
model.compile(optimizer='adam', loss='mse')

n_steps = 5
n_features = 1
```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba2972f6395642b6b6bed332926c245a~tplv-k3u1fbpfcp-zoom-1.image)

## 2. å¤šè¾“å…¥å•è¾“å‡ºï¼ˆå•è¾“å‡ºæ—¶é—´æ­¥ï¼‰
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92699fe037ee4c4bab8db1cc899be2d3~tplv-k3u1fbpfcp-zoom-1.image)
- **è¾“å…¥ï¼šå¤šä¸ªç‰¹å¾ï¼Œå¤šä¸ªæ—¶é—´æ­¥**
- **è¾“å‡ºï¼šå•ä¸ªç‰¹å¾ï¼Œå•ä¸ªæ—¶é—´æ­¥**

**ğŸ¥« æ•°æ®æ¡ˆä¾‹**

```python
è®­ç»ƒé›†ï¼š
X                       y
[[10,11], 
 [20,21],
 [30,31],
 [40,41],
 [50,51]]               60
[[20,21],
 [30,31],
 [40,41],
 [50,51],
 [60,61]]               70
â€¦


é¢„æµ‹è¾“å…¥ï¼š
X
[[30,31],
 [40,41],
 [50,51],
 [60,61],
 [70,71]]
æœŸå¾…è¾“å‡ºï¼š
y
80
```


**ğŸ¥  TensorFlow2ä»£ç å®ç°**

```python
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')

n_steps = 5
# æ­¤ä¾‹ä¸­ n_features = 2ï¼Œå› ä¸ºè¾“å…¥æœ‰ä¸¤ä¸ªå¹¶è¡Œåºåˆ—
n_features = X.shape[2]
```
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53fc72c0fab44ff49b1faf632a6ce349~tplv-k3u1fbpfcp-zoom-1.image)
## 3. å¤šè¾“å…¥å¤šè¾“å‡ºï¼ˆå•è¾“å‡ºæ—¶é—´æ­¥ï¼‰
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/235926f2acdb435ab16cf1934916fb08~tplv-k3u1fbpfcp-zoom-1.image)
- **è¾“å…¥ï¼šå¤šä¸ªç‰¹å¾ï¼Œå¤šä¸ªæ—¶é—´æ­¥**
- **è¾“å‡ºï¼šå¤šä¸ªç‰¹å¾ï¼Œå•ä¸ªæ—¶é—´æ­¥**

**ğŸ¥« æ•°æ®æ¡ˆä¾‹**

```python
è®­ç»ƒé›†ï¼š
X                       y
[[10,11], 
 [20,21],
 [30,31],
 [40,41],
 [50,51]]               [60,61]
[[20,21],
 [30,31],
 [40,41],
 [50,51],
 [60,61]]               [70,71]
â€¦


é¢„æµ‹è¾“å…¥ï¼š
X
[[30,31],
 [40,41],
 [50,51],
 [60,61],
 [70,71]]
æœŸå¾…è¾“å‡ºï¼š
y
[80,81]
```


**ğŸ¥  TensorFlow2ä»£ç å®ç°**

```python
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps, n_features)))
model.add(Dense(n_features))
model.compile(optimizer='adam', loss='mse')

n_steps = 5
# æ­¤ä¾‹ä¸­ n_features = 2ï¼Œå› ä¸ºè¾“å…¥æœ‰2ä¸ªå¹¶è¡Œåºåˆ—
n_features = X.shape[2]
```
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/047095dc06584394add020fdb1d537a3~tplv-k3u1fbpfcp-zoom-1.image)

## 4. å•è¾“å…¥å•è¾“å‡ºï¼ˆå¤šè¾“å‡ºæ—¶é—´æ­¥ï¼‰
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e9300183a8540ffaf47fabd21862c76~tplv-k3u1fbpfcp-zoom-1.image)

- **è¾“å…¥ï¼šå•ä¸ªç‰¹å¾ï¼Œå¤šä¸ªæ—¶é—´æ­¥**
- **è¾“å‡ºï¼šå•ä¸ªç‰¹å¾ï¼Œå¤šä¸ªæ—¶é—´æ­¥**

**ğŸ¥« æ•°æ®æ¡ˆä¾‹**

```python
è®­ç»ƒé›†ï¼š
X                       y
[10,20,30,40,50]       [60,70]
[20,30,40,50,60]       [70,80]
â€¦


é¢„æµ‹è¾“å…¥ï¼š
X
[30,40,50,60,70]
æœŸå¾…è¾“å‡ºï¼š
y
[80,90]
```


**ğŸ¥  TensorFlow2ä»£ç å®ç°**

```python
model = Sequential()
model.add(LSTM(100, activation='relu', return_sequences=True, input_shape=(n_steps, n_features)))
model.add(Dense(n_steps_out))
model.compile(optimizer='adam', loss='mse')


n_steps = 5
n_steps_out = 2
n_features = 1
```
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b8938d5a5fc246c2ad6b5c7bcfb19c3c~tplv-k3u1fbpfcp-zoom-1.image)

å¤šè¾“å…¥å•è¾“å‡ºï¼ˆå¤šè¾“å‡ºæ—¶é—´æ­¥ï¼‰ä¸å¤šè¾“å…¥å¤šè¾“å‡ºï¼ˆå¤šè¾“å‡ºæ—¶é—´æ­¥ï¼‰åŒç†ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/71e8a3bb051b4f6e982fde3961d9f42e~tplv-k3u1fbpfcp-zoom-1.image)

>å‚è€ƒæ–‡ç« 
>- https://zhuanlan.zhihu.com/p/59862381
>- https://zhuanlan.zhihu.com/p/139617364


-   æˆ‘æ­£åœ¨å‚ä¸æ˜é‡‘æŠ€æœ¯ç¤¾åŒºåˆ›ä½œè€…ç­¾çº¦è®¡åˆ’æ‹›å‹Ÿæ´»åŠ¨ï¼Œ[ç‚¹å‡»é“¾æ¥æŠ¥åæŠ•ç¨¿](https://juejin.cn/post/7112770927082864653 "https://juejin.cn/post/7112770927082864653")ã€‚